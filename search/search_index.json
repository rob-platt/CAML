{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"Welcome to CAML","text":"<p>The CRISM Analysis with Machine Learning (CAML) software exists to mineral identification in CRISM imagery using machine learning. This system is designed to be easy to use (no-code), platform agnostic, and to provide a high level of accuracy in mineral identification. It is designed for use by planetary science researchers, students, and enthusiasts.</p>"},{"location":"#getting-started","title":"Getting Started","text":"<p>To get started with CAML, you will need to install the system on your computer. This is available as a standalone desktop application, or as a Python package. The desktop application is recommended for users who are not familiar with Python, while the Python package is recommended for users who are familiar with Python and want to use CAML in their own scripts.</p>"},{"location":"#desktop-application","title":"Desktop Application","text":"<p>The desktop application is available for Windows, macOS, and Linux. To install the desktop application, download the appropriate installer from the releases page and follow the installation instructions for your operating system.</p>"},{"location":"#windows","title":"Windows","text":"<p>Download the \"WindowsOS_CAML_vX_X_X.zip\" file from the releases page. Extract the contents of the zip file to a folder on your computer. Run the \"CAML.exe\" file to start the application. Alternatively, you can start the program from the command line by navigating to the folder where you extracted the files and running the following command:</p> <pre><code>&amp; .\\CAML.exe\n</code></pre>"},{"location":"#macos","title":"macOS","text":"<p>Download the \"macOS_CAML_vX_X_X.zip\" file from the releases page. Extract the contents of the zip file to a folder on your computer. From the command line, navigate to the folder where you extracted the files and running the following commands:</p> <pre><code>xattr -r -d com.apple.quarantine _internal/*\n./CAML\n</code></pre>"},{"location":"#linux","title":"Linux","text":"<p>Download the \"LinuxOS_CAML_vX_X_X.zip\" file from the releases page. Extract the contents of the zip file to a folder on your computer. Start the program from the command line by navigating to the folder where you extracted the files and running the following command:</p> <pre><code>./CAML\n</code></pre>"},{"location":"#python-package","title":"Python Package","text":"<p>The Python package is available on Github.</p> <p>To create a new conda environment and install the package, run the following commands:</p> <pre><code>conda env create -f environment.yml\nconda activate caml\n</code></pre> <p>Or you can install the dependencies into a virtual environment of your choice using the <code>requirements.txt</code> file:</p> <p><pre><code># Activate your virtual environment\npip install -r requirements.txt\n</code></pre> To run the application, use the following command:</p> <pre><code>python main.py\n</code></pre> <p>Note</p> <p>This python package only releases code for running inference of the ML model. A separate, later release will include the model itself, preprocessing, and training code. </p>"},{"location":"#citation","title":"Citation","text":"<p>If you find this software useful, please cite the following paper:</p> <p>Platt, R., Arcucci, R. &amp; John, C.M., 2024. Automated classification of CRISM spectra using hybrid neural networks. Tenth International Conference on Mars 2024, LPI Contributions, 3007, p.3166. Available at: https://ui.adsabs.harvard.edu/abs/2024LPICo3007.3166P.</p> <pre><code>@inproceedings{platt_automated_2024,\n    title = {Automated Classification of CRISM Spectra Using Hybrid Neural Networks},\n    language = {en},\n    booktitle = {Tenth International Conference on Mars 2024},\n    series = {LPI Contributions},\n    volume = {3007},\n    author = {Platt, R and Arcucci, R and John, C M},\n    year = {2024},\n    eid = {3166},\n    pages = {3166},\n    adsurl = {https://ui.adsabs.harvard.edu/abs/2024LPICo3007.3166P},\n}\n</code></pre>"},{"location":"How_To_Use/","title":"How To Use the Desktop Application","text":""},{"location":"How_To_Use/#selecting-crism_ml-data","title":"Selecting CRISM_ML Data","text":"<p>When you run CAML, the first thing you will be prompted for is the directory containing the CRISM_ML training dataset. This must be a folder, containing the <code>CRISM_bland_unratioed.mat</code> file for training the bland pixel classifier from Plebani et al. 2022 (Github Link). This dataset can be found here.</p> <p>Warning</p> <p>CAML cannot load CRISM imagery without this dataset. The dataset must be named <code>CRISM_bland_unratioed.mat</code></p>"},{"location":"How_To_Use/#loading-a-crism-image","title":"Loading a CRISM Image","text":"<p>CAML is designed to work solely with CRISM L sensor TRDR images with TRR3 processing. Standard photometric and atmospheric corrections, including the \"Volcano-Scan\" atmospheric correction, are also expected to have been applied before loading the image into CAML. There are two methods for acquiring this data:  </p> <ul> <li>Downloading the data from the PDS Geosciences Node, and then applying the corrections using the CRISM Analysis Toolkit (CAT) with ENVI software.</li> <li>Using MarsSI to source CRISM images with the desired corrections already applied. The data products from MarsSI with the <code>_CAT_corr.img</code> suffix are the ones to use. NB: The suffix must be removed to load the image into CAML. <pre><code>Example: \"FRT00009A16_07_IF166L_TRR3_CAT_corr.img\" -&gt; \"FRT00009A16_07_IF166L_TRR3.img\"\n         \"FRT00009A16_07_IF166L_TRR3_CAT_corr.hdr\" -&gt; \"FRT00009A16_07_IF166L_TRR3.hdr\"\n         \"FRT00009A16_07_IF166L_TRR3.lbl\" -&gt; \"FRT00009A16_07_IF166L_TRR3.lbl\"\n</code></pre></li> </ul> <p>The directory containing the <code>.img</code> file must also contain the <code>.lbl</code> file of the image. The loading process may take up to a few minutes.</p>"},{"location":"How_To_Use/#basic-visualisation-controls","title":"Basic Visualisation Controls","text":"<p>After loading a CRISM image, you will be presented with the image alongside a plot of individual spectra. You can pan and zoom on the image plot using the controls underneath it (3). Hovering over a pixel  will display the spectrum for that pixel in the plot. Left clicking on a pixel will keep that pixel displayed until you left click again.</p> <p></p> <p>The following controls are available:  </p> <ul> <li>Image Selection (1): Choose between visualising a ratioed image band, or a summary product (e.g. LCPINDEX2) created from the ratioed image.</li> <li>Image Channel Selection (2): If visualising an image band, select which band to display.</li> <li>Spectrum wavelength range (4): Choose the range of wavelengths to display in the spectrum plot.</li> <li>Classification (5): Button to run classification across the image using the CAML model. This will take a few minutes to complete.</li> </ul> <p>Tip</p> <p>For identification of most hydrated mineral features, plotting between 1.0 and 2.6 microns is recommended.</p>"},{"location":"How_To_Use/#classification","title":"Classification","text":"<p>After pressing the classification button, the CAML model will conduct pixel-wise classification across the image. This should be possible with almost any level of hardware<sup>1</sup>, as the model is relatively small. The classification process may take a few minutes to complete, depending on the size of the image and the hardware being used. </p>"},{"location":"How_To_Use/#advanced-visualisation-controls-post-classification","title":"Advanced Visualisation Controls (Post-Classification)","text":"<p>After classification has been completed, the predicted mineralogy will be displayed on top of the image. </p> <p></p> <p>The following additional controls will become available:</p> <ul> <li>Classification Results (On/Off) (1): Toggle the mineralogy overlay on the image.</li> <li>Two filtering options:  <ul> <li>Minimum Confidence (2): Minimum confidence level to display prediction averaged across the connected component<sup>2</sup>.  </li> <li>Connected Components (3): Minimum number of pixels of the same mineralogy in a contiguous region to display.</li> </ul> </li> <li>Run Filtering (4): This will apply the chosen filtering options (together) to the classification results.</li> <li>Spectral Reconstruction (On/Off) (5): Toggle the spectral reconstruction overlay on the image. </li> <li>Save Image (6): Save the image with the current mineralogy overlay and filtering applied.</li> </ul>"},{"location":"How_To_Use/#spectral-reconstructions","title":"Spectral Reconstructions","text":"<p>One output produced by the CAML model are the spectral reconstructions for the first 248 bands of each pixel. These are often less noisy than the original spectra, and allow for easier manual verification of mineral predictions. The spectral reconstructions can be toggled on and off using the <code>Spectral Reconstruction</code> button.</p> <p>Warning</p> <p>The spectral reconstructions are not the same as the original spectra, and should not be used for quantitative analysis. They are only intended to help with manual verification of mineral predictions. Absorption feature centres and depths may be shifted from the original spectra.</p>"},{"location":"How_To_Use/#saving-results","title":"Saving Results","text":""},{"location":"How_To_Use/#saving-graphics","title":"Saving Graphics","text":"<p>The image plot currently displayed can be saved as a .png file by using the  icon underneath the image plot. This will save the image with the current mineralogy overlay and any filtering applied.</p>"},{"location":"How_To_Use/#saving-crism-image","title":"Saving CRISM Image","text":"<p>The CRISM image can be written out to an .img file using the <code>Save Image</code> button. This will save the original image to a new directory, with the mineral predictions as band 437, and the confidence levels as band 438. The current mineralogy overlay displayed are the predictions that will be saved, with all other pixels labelled as no data (65535 for CRISM data)<sup>3</sup>. </p> <p>To allow for ENVI + CAT compatability (for map projection and further analysis), the image must be saved using the exact name of the original image file. Therefore please pick a new directory to save the image to, and ensure the original image file is not in that directory. The header (.hdr) and label (.lbl) files will also be saved. </p> <ol> <li> <p>Minimum 8GB RAM recommended. Currrently no GPU support.\u00a0\u21a9</p> </li> <li> <p>There are several ways these two filtering steps could be combined, we found this to give the most visually sensible results.\u00a0\u21a9</p> </li> <li> <p>This allows for easy visualisation in GIS software, without having to compute additional filtering. If you wish to have access to all of the predictions and filter in GIS, set the minimum confidence to 0.0 and the connected components to 0 before saving.\u00a0\u21a9</p> </li> </ol>"},{"location":"Machine_Learning/","title":"CAML Methodology","text":"<p>The classification model implemented in CAML is based on the model introduced in Platt et al. 2024.</p> <p>This is a hybrid neural network which combines a Variational Autoencoder (VAE) as a generative model, with a Convolutional Neural Network (CNN) to classify the spectra. The CNN uses the latent space from the VAE to predict the mineralogy per pixel. The output from the VAE (the \"reconstructions\") are the optional \"reconstruction\" spectra visualised in CAML. </p>"},{"location":"Machine_Learning/#further-details","title":"Further Details","text":"<p>Note</p> <p>Further details on model training, performance, and validation - beyond those in Platt et al. 2024 - will be provided in a future publication.</p>"},{"location":"WiP/","title":"Features Currently in Development","text":"<ul> <li>Additional colours for all minerals in the classifier dataset.</li> </ul>"},{"location":"WiP/#requests","title":"Requests","text":"<ul> <li>If someone has a python port of the IDL map projection code, that would be immensely helpful. This would allow for direct use of data in GIS software, and remove the need for expensive IDL licenses. The entire software pipeline would then be FOSS.</li> </ul> <p>If there are additional features you would like for this software, please contact the developers via email rp1818@ic.ac.uk, raise an issue on the GitHub repository, or submit a pull request with the feature you would like to see.</p>"}]}